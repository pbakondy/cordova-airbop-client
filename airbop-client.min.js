angular.module("AirBopClient",[]).factory("$airbopClient",["$http","$q",function(t,e){"use strict";function r(){return Math.floor((new Date).getTime()/1e3)}function i(t,e,r,i){return t+e+s+r+i+u}function o(t){if("function"!=typeof sha256)throw"Missing `sha256()` function";return sha256(t)}function n(n,p){var a=e.defer(),u=r(),g=i(f,p,u,JSON.stringify(n)),l=o(g),c={};c[K]=s,c[I]=u,c[j]=l,c[x]=y;var h={data:n,headers:c,method:f,params:n,timeout:d,url:p};return t(h).then(function(t){200===t.status?a.resolve("OK"):a.reject({data:t.data,status:t.status,statusText:t.statusText})},a.reject),a.promise}function p(t){if("string"!=typeof t.airbopAppKey)throw"Invalid `airbopAppKey` option";if("string"!=typeof t.airbopAppSecret)throw"Invalid `airbopAppSecret` option";if("string"!=typeof t.regid)throw"Invalid `regid` option";s=t.airbopAppKey,u=t.airbopAppSecret;var r=e.defer(),i={};return i[w]=t.regid,"string"==typeof t.country&&(i[h]=t.country),"string"==typeof t.state&&(i[S]=t.state),"string"==typeof t.label&&(i[b]=t.label),"string"==typeof t.language&&(i[v]=t.language),"string"==typeof t.latitude&&(i[A]=t.latitude),"string"==typeof t.longitude&&(i[m]=t.longitude),n(i,l).then(r.resolve,r.reject),r.promise}function a(t){if("string"!=typeof t.airbopAppKey)throw"Invalid `airbopAppKey` option";if("string"!=typeof t.airbopAppSecret)throw"Invalid `airbopAppSecret` option";if("string"!=typeof t.regid)throw"Invalid `regid` option";s=t.airbopAppKey,u=t.airbopAppSecret;var r=e.defer(),i={};return i[w]=t.regid,n(i,c).then(r.resolve,r.reject),r.promise}var s,u,f="POST",g="http://www.airbop.com/api/v1/",l=g+"register",c=g+"unregister",y="application/json",d=6e4,h="country",b="label",v="lang",A="lat",m="long",w="reg",S="state",K="x-app-key",I="x-timestamp",j="x-signature",x="Content-Type";return{register:p,unregister:a}}]);